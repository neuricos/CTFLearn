#!/usr/bin/env python3

f = open("dawn2.txt", "r")

levels = ('.', '_', '\\', '-', '/', '|', '*')
lawn = [list(l.strip()) for l in f.readlines()]

lawn_len = len(lawn)
growth_speed = lawn_len
growing_tiles = []

loc = (0, 0)
# 1 -> going downward
# -1 -> going upward
direction = 1

end_loc = (0 if lawn_len % 2 == 0 else lawn_len - 1, lawn_len)

while loc != end_loc:
    # trim
    row, col = loc
    state = lawn[row][col]
    idx = levels.index(state)
    idx -= 2
    idx = max(idx, 0)
    lawn[row][col] = levels[idx]
    # update location
    if idx != 0:
        growing_tiles.append([loc, growth_speed])

    if row + direction < 0 or row + direction >= lawn_len:
        loc = (row, col + 1)
        direction *= -1
    else:
        loc = (row + direction, col)
    # grow
    for gt in growing_tiles:
        gt[1] -= 1
        if gt[1] == 0:
            r, c = gt[0]
            s = lawn[r][c]
            i = levels.index(s)
            i += 1
            i = min(i, len(levels) - 1)
            lawn[r][c] = levels[i]
            gt[1] = growth_speed

flowers = sum([sum([1 if c == levels[-1] else 0 for c in row]) for row in lawn])
print(f"Total number of flowers = {flowers}")

f.close()